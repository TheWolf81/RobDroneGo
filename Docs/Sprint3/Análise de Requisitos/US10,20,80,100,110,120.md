# Análise de requisitos US relativas a utilizadores e autenticação

## Atributos de um utilizador:

* firstName
* lastName
* username
* password
* role (pode ser campusManager, fleetManager, systemAdministrator, taskManager ou Client)
* nr_telefone
* nif
* status (pode ser approved, denied ou requested)

## Abordagem para a criação de utilizadores:

 ### Para System Admins

 * Pode criar utilizadores de qualquer role US(10)
 * Aprova ou Recusa contas de utentes que serão guardadas na base de dados como contas de utilizadores no estado "requested".
    O System Admin seleciona um pedido da lista de pedidos no estado "requested" e depois seleciona se quer aceitar ou recusar o pedido. Caso esse pedido seja aceite, o usuário poderá fazer login e o estado da conta passa para "approved"  Caso seja recusado, a conta mantém-se no sistema. (US80)

 ### Para Utentes

 * Apenas podem criar "pedidos de registo", sendo necessário aprovação por admin.(US20)
 * Terá que aprovar uma checkbox de consentimento ao tratamento de dados. Caso não aprovado, a conta não será criada.


## Funcionalidades Adicionais dos Utentes

* Podem alterar ou retificar os dados da conta (US100)
* Podem obter uma cópia dos dados em JSON (US110)
* Podem apagar a sua conta, sendo os dados complemente eliminados (US120)

## US100 - Alterar dados da conta: Abordagem

Dados passíveis de alteração:
 * firstName
 * lastName
 * username
 * nr_telefone
 * nif

Nota: A password não pode ser alterada por esta funcionalidade.

* Para obter o registo de base de dados da conta, será utilizado o id enviado do token de autenticação.
* Para alterar os dados, o token terá que ter o role de "Client".
* Assume-se que os restantes utilizadores têm a conta criada por um System Admin, e que a retificação dos dados não tem tanta importância como para os utilizadores "Client" da aplicação. 

## US110 - Obter cópia dos dados do utilizador: Abordagem

* O utilizador poderá tranferir uma cópia dos seus dados pessoais, que deverá vir em formato JSON
* Qualquer utilizador pode fazer o download desta cópia, apenas necessita de estar autenticado no momento do requerimento
* Para obter o id da conta, será utilizado o id ou e-mail enviado do token de autenticação.

Dados fornecidos na cópia:
* firstName
* lastName
* username
* email
* nr_telefone
* nif

Nota: A password e o role não são fornecidos por motivos de segurança

* O ficheiro resultante será gerado e o utilizador poderá escolher se deseja fazer download, e onde quer guardar o ficheiro, como normalmente fazemos no browser. O nome ficheiro terá o formato primeiroNome_ultimoNome_nif
* Se a funcionalidade for executada no Postman, é apresentado apenas o conteúdo do ficheiro no corpo da resposta, dado que o Postman já possui uma feature que permite fazer download duma resposta num ficheiro

## US120 - Apagar a conta do utilizador: Abordagem

* O utilizador, enquanto cliente poderá apagar a sua conta, sendo que todos os dados serão eliminados da base de dados.
* A operação de apagar a conta é irreversível.
* Para obter o id da conta, será requerido o email e password do cliente. Esta abordagem é justificada pelo caso de clientes que estão no estado "requested" ou "denied", que não podem efetuar login e querem exercer o direito de eliminar os seus dados da base de dados. De outra forma, seria utilizado o  token de autenticação.

* Para apagar a conta, terá que ter o role de "Client".

